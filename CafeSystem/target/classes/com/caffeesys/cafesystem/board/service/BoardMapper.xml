<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.caffeesys.cafesystem.board.service.BoardMapper">
	<resultMap type="com.caffeesys.cafesystem.board.service.BoardVO" id="resultBoard">
		<result column="board_code" property="boardCode"/>	<!-- 게시글코드(PK) -->
		<result column="category_code" property="categoryCode"/>	<!-- 카테고리(FK) -->
		<result column="employee_code" property="employeeCode"/>	<!-- 직원코드(FK) -->
		<result column="board_title" property="boardTitle"/>	<!-- 제목 -->
		<result column="board_content" property="boardContent"/>	<!-- 내용 -->
		<result column="board_date" property="boardDate"/>	<!-- 날짜 -->
		<result column="board_file" property="boardFile"/>	<!-- 첨부파일 -->
	</resultMap>
	
	<!-- CategoryVo resultMap -->
	<resultMap type="com.caffeesys.cafesystem.Category" id="resultCategory">
		<result column="category_code" property="categoryCode" /> <!-- 코드(PK) -->
		<result column="category_large" property="categoryLarge"  /> <!-- 대분류 -->
		<result column="category_middle" property="categoryMiddle"  /> <!-- 중분류 -->
		<result column="category_small" property="categorySmall"  /> <!-- 소분류 -->
	</resultMap>
	
		<!-- 페이징 작업을 위한 board 레코드 개수 -->
		<select id="getBoardCount" resultType="int">
			select count(*) from board 
		</select>
		
		<!-- board리스트 select -->
		<select id="selectBoardList"  parameterType="java.util.Map" resultMap="resultBoard">
			SELECT 
			 	board_code
				 ,category_code
				 ,employee_code
				 ,board_title
				 ,board_content
				 ,board_date
				 ,board_file 		 	
			FROM board  
			ORDER BY board_code ASC 
			LIMIT #{beginRow}, #{pagePerRow};
		</select>
		
		<!-- board 카테고리 불러오기 -->
		<select id="selectBoardCategory" resultMap="resultCategory">
			SELECT
				category_code
				,category_large
				,category_middle
				,category_small
			FROM category 
			WHERE category_middle = 'Board'
		</select>
		
		<!-- board insert -->
		<insert id="insertBoard" parameterType="com.caffeesys.cafesystem.board.service.BoardVO">
			INSERT INTO board (
				board_code
				,category_code
				,employee_code
				,board_title
				,board_content
				,board_date
				,board_file
			) VALUES (
				#{boardCode}
				,#{categoryCode}
				,#{employeeCode}
				,#{boardTitle}
				,#{boardContent}
				,now()
				,#{boardFile}
			)
		</insert>
	</mapper>
	
	