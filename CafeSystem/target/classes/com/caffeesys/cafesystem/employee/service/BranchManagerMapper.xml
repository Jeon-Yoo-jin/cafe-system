<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper   
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.caffeesys.cafesystem.employee.service.BranchManagerMapper">
	<resultMap type="com.caffeesys.cafesystem.employee.service.BranchManager" id="resultBranchManager">
		<result property="branchEmployeeCode" column="branch_employee_code"/> <!-- 직원코드 -->
		<result property="localCategoryCode" column="local_category_code"/><!-- 지역코드 -->
		<result property="shopCode" column="shop_code"/><!-- 매장코드 -->
		<result property="positionCategoryCode" column="position_category_code"/><!-- 직급코드 -->
		<result property="branchEmployeeId" column="branch_employee_id"/><!-- 아이디 -->
		<result property="branchEmployeeName" column="branch_employee_name"/><!-- 이름 -->
		<result property="branchEmployeeBirth" column="branch_employee_birth"/><!-- 생년월일 -->
		<result property="branchEmployeePhone" column="branch_employee_phone"/><!-- 연락처 -->
		<result property="branchEmployeeAddress" column="branch_employee_address"/><!-- 주소 -->
		<result property="branchEmployeeCetificate" column="branch_employee_cetificate"/><!-- 보건증 -->
		<result property="branchManagerWorknum" column="branch_manager_worknum"/><!-- 사업자번호 -->
		<result property="branchManagerStart" column="branch_manager_start"/><!-- 사업시작일 -->
		<result property="branchManagerBank" column="branch_manager_bank"/><!-- 사업계좌은행명 -->
		<result property="branchManagerBanknum" column="branch_manager_banknum"/><!-- 사업계좌번호 -->
	</resultMap>
  

	<!-- DB branch_employee에서 직원코드 숫자 최댓값 구하는 select -->
	<select id="selectBranchImployeeCodeMax" resultType="Integer">
		select max(CAST(substring(branch_employee_code,6) AS DECIMAL))  
		from branch_employee		
	</select>
	
	<!-- DB branch_employee에서 지역에 따른 매장 코드 최댓값 구하는 select -->
	<select id="selectBranchEmployeeShopCodeMax" resultType="String" parameterType="com.caffeesys.cafesystem.employee.service.BranchManager">
		SELECT DISTINCT max(shop_code) 
      	FROM branch_employee
      	WHERE local_category_code = #{localCategoryCode}
	</select>
	
	 <!-- DB  branch_employee에 지점장 입력내용 추가 -->
	<insert id="insertBranchImployeeB" parameterType="com.caffeesys.cafesystem.employee.service.BranchManager">
		INSERT INTO branch_employee
			(branch_employee_code, local_category_code, shop_code, position_category_code, branch_employee_id, branch_employee_name, branch_employee_birth, branch_employee_phone, branch_employee_address, branch_employee_cetificate)
		VALUES 
			('#{branchEmployeeCode}', 
			'#{localCategoryCode}', 
			'#{shopCode}', 
			'#{positionCategoryCode}', 
			'#{branchEmployeeId}', 
			'#{branchEmployeeName}', 
			'#{branchEmployeeBirth}', 
			'#{branchEmployeePhone}', 
			'#{branchEmployeeAddress}', 
			'#{branchEmployeeCetificate}')	
	</insert>
	
	
	
	
	

</mapper>